#include <stdlib.h>
#include <sys/stat.h>
#include <assert.h>
#include <stdio.h>
#include <string.h>
#include <fcntl.h>
#include <unistd.h>
#include <errno.h>

int main() {
	int fd, i;
	ssize_t rd;
	char buf[100];

	fd = open("/dev/hello_counted", O_RDWR);
	if(fd < 0){
		perror("open: ");
		return 1;
	}
	
	for(i = 0; i < 5; i++) {
        rd = read(fd, buf,100);
        if(i==0)
            assert(strcmp(buf, "Hello, from grp5. You have read 0 bytes so far.") == 0);
        else if(i==1)
            assert(strcmp(buf, "Hello, from grp5. You have read 48 bytes so far.") == 0);
        else if(i==2)
            assert(strcmp(buf, "Hello, from grp5. You have read 97 bytes so far.") == 0);
        else if(i==3)
            assert(strcmp(buf, "Hello, from grp5. You have read 146 bytes so far.") == 0);
        else if(i==4)
            assert(strcmp(buf, "Hello, from grp5. You have read 196 bytes so far.") == 0);
    }
    
    if(close(fd) < 0)
        perror("close: ");
	
	return 0;
}
